1.display details of jobs where the minimum salary is greater than 10000?
select e.jobtitle,s.salary from emp9 e,salary s where e.eno=s.eno and salary>10000
select e.jobtitle,s.salary from emp9 e,salary s where e.eno=s.eno and salary between 10100 and 12000
select e.jobtitle,s.salary from emp9 e,salary s where e.eno=s.eno and salary >10000 and salary<=12000


2.display the first name and joindate of employees who joined between 2000 and 2005?
select e.ename,j.doj from emp9 e,joindate j where e.eno=j.eno and doj between '1-1-2000' and '31-12-2005'
select e.ename,j.doj from emp9 e,joindate j where e.eno=j.eno and doj>='1-1-2000' and doj<='31-12-2005'


3.display first name and join date from employee who is either salesman or clerk?
select e.ename,j.doj,e.jobtitle from emp9 e,joindate j where e.eno=j.eno and  jobtitle in('salesman','clerk')
select e.ename,j.doj from emp9 e,joindate j where e.eno=j.eno and  jobtitle='clerk' and jobtitle='salesman'(doubt)


4.display employees who joined after 1st january 2008?
select e.eno,j.doj from emp9 e,joindate j where e.eno=j.eno and doj>'1-1-2008'
select e.eno,j.doj from emp9 e,joindate j where e.eno=j.eno and doj<'31-12-2017' and doj>'1-1-2008'
select e.eno,j.doj from emp9 e,joindate j where e.eno=j.eno and doj between '2-2-2008' and '31-12-2017'


5.display details of employee whose id is 108 or 109?
select * from emp9 where eno=108
select * from emp9 where eno=108 or eno=109
select * from emp9 where eno in(108)



6.display ename,salary and doj for employees with salary lessthan 10000?
select e.ename,s.salary,j.doj from emp9 e,salary s,joindate j where e.eno=s.eno and e.eno=j.eno and salary<10000
select e.ename,s.salary,j.doj from emp9 e,salary s,joindate j where e.eno=s.eno and e.eno=j.eno and salary between 0 and 9999
select e.ename,s.salary,j.doj from emp9 e,salary s,joindate j where e.eno=s.eno and e.eno=j.eno and salary>0 and salary<10000             
select * from emp9


7.display jobtitle, the difference between min and max salary?
select e.jobtitle,min(s.salary),max(s.salary),min(s.salary)-max(s.salary) as saldiff from emp9 e,salary s where e.eno=s.eno 
and salary between 2000 and 10000 group by e.jobtitle
select e.jobtitle,min(s.salary),max(s.salary),min(s.salary)-max(s.salary) as saldiff from emp9 e,salary s where e.eno=s.eno 
and salary>=2000 and salary<=10000 group by e.jobtitle,s.salary



8.display  ename,salary and round salary to thousands?
select e.ename,s.salary,round(s.salary,-3) from emp9 e,salary s where e.eno=s.eno     
select * from salary


9.display details of jobs in descending order of the title?
select * from emp9 order by jobtitle desc


10.display employees where the ename starts with "s"?
select ename from emp9 where ename like 's%'     
select * from joindate alter table salary add commpercen varchar(50)  
update salary set commpercen=750.675 where salary between 11000 and 12000


11.display emp who joined in month of may?
select e.ename,count(*),to_char(j.doj,'mm') from emp9 e,joindate j where e.eno=j.eno group by to_char(j.doj,'mm'),e.ename having to_char(j.doj,'mm')=5
select * from joindate where doj like '%-05-%'


12.display details of emp where commision percentage is null and salary in range 5000 to 10000 and dep is 30?
select e.ename,s.commpercen,s.salary from emp9 e,salary s where e.eno=s.eno and s.commpercen is null and s.salary between 5000 and 9000 and e.dno=42
               commit


13.display first name and date  of first salary of employee?
select e.ename,e.eno,j.doj,j.doj+30 as firstsalary from emp9 e,joindate j where e.eno=j.eno


14.display ename,experience of the emp?
select e.ename,round(((sysdate-j.doj)/365),0) exp from emp9 e,joindate j where e.eno=j.eno


15.display ename,doj of emp who joine in 2010
select e.ename,j.doj from emp9 e,joindate j where e.eno=j.eno and doj>='1-1-10' and doj<='31-12-10'
select e.ename,j.doj from emp9 e,joindate j where e.eno=j.eno and doj between '1-1-10' and '31-12-10'


21.display no. of days between systemdate and 1st jan 2011?
select sysdate-to_date('01-jan-2011') from dual    
select * from emphistory


22.display how many emp's joined in each month of current year?
select e.ename,count(*),to_char(j.doj,'mm') from emp9 e,joindate j where e.eno=j.eno group by to_char(j.doj,'mm'),e.ename order by to_char(j.doj,'mm')


23.display managerid and no.of employees joined managed by manager?
select m.mno,count(e.eno) from manager m,emp9 e where m.mno=e.mno group by m.mno


24.display empno and date on which he ended his previous job?
select e.eno,h.enddate,h.previouscompany from emp9 e,emphistory h where e.eno(+)=h.eno


25.display no. of emp joined after 15th of the month?
select e.ename,count(*),to_char(j.doj,'dd') from emp9 e,joindate j where e.eno=j.eno  group by to_char(j.doj,'dd'),e.ename having to_char(j.doj,'dd')>3
select  * from dep2 alter table salary add dno number   update salary set dno=63 where eno=116


26.display the country id and no.of cities we have in the country?                
select * from emp9
select count(*),location,country from dep2 group by location
delete column eno from dep2


27.display avg salaries of the emp in each department who have commision percentage?
select d.dno,avg(s.salary) from salary s,dep2 d where d.dno=s.dno and commpercen is not null group by d.dno order by d.dno


28.display job id,no.of employees,sum of salary and difference between highest and lowest salary of emp of job?
select e.eno,sum(s.salary),count(*),max(s.salary),min(s.salary),max(s.salary)-min(s.salary) as salarydiff from emp9 e,salary s where e.eno=s.eno(+) 
group by e.eno order by e.eno
select * from salary
select * from emp9


29.display jobid for jobs with avg salary more than 10000
select e.eno,avg(s.salary) from emp9 e,salary s where e.eno=s.eno group by e.eno having avg(salary)>4000 order by e.eno


30.display years in which more than 10 emp joined? 
select count(*),e.ename,to_char(j.doj,'yy'),e.eno from emp9 e,joindate j where e.eno=j.eno 
group by to_char(j.doj,'yy'),e.ename,e.eno having count(e.eno)>1


31.display dep's in which more than five emp's have commission percentage?
select d.dname,d.dno,count(*) from emp9 e,salary s,dep2 d where e.eno=d.eno and e.eno=s.eno  
and s.commpercen is not null group by d.dname,d.dno having count(*)>=1 order by d.dno


39.change jobid of emp110 to it-programmer if the employee belongs to dep10 and existing job doesn't start with it?
select * from emp9
update emp9 set jobtitle='clerk' where eno=125 and dno=97 and not jobtitle like 'cl%'


40.insert a row into dep table with manager id 121 and location id in any location id for city tokyo?
alter table dep2 add mno number update dep2 set mno=126 where dno=46
select * from dep2
insert into dep2 values(51,'manager','shangai','tokyo',111,120)


41.display depname and no.of employees in dep?
select d.dno,count(d.dno),d.dname,e.ename from emp9 e,dep2 d where d.dno=e.dno group by d.dno,e.ename,d.dname order by d.dno


42.display job title,empid,no.ofdays between end date and start date for all jobs in dep30 from jobhistory?
select e.jobtitle,e.eno,(h.enddate-h.startdate)as days from emp9 e,emphistory h where e.eno=h.eno and e.dno=45


43.display depname and manager name?
select d.dname,m.managername from dep2 d,manager m where d.mno=m.mno


44.display department name,manager name and city?
select d.dname,m.managername,d.location from dep2 d,manager m where d.mno=m.mno


45.display countryname,city name and department name?
select d.dname,d.country,d.location from dep2 d,manager m where d.mno=m.mno


46.display job title,depname,empname,joindate for all jobs from 2000 to 2005?
select d.dname,e.jobtitle,e.ename,j.doj from emp9 e,dep2 d,joindate j where e.eno=d.eno and e.eno=j.eno and j.doj between '1-1-10' and '31-12-15'
select d.dname,e.jobtitle,e.ename,j.doj from emp9 e,dep2 d,joindate j where e.eno=d.eno and e.eno=j.eno and j.doj>='1-1-10' and j.doj<='31-12-15'


47.display jobtitle and average salary of emp's?
select e.jobtitle,avg(s.salary) from emp9 e,salary s where e.eno=s.eno  group by e.jobtitle


48.display jobtitle,empname, and difference between max salary for the job and salary of the employee?
select e.jobtitle,e.ename,s.salary,max(s.salary),max(s.salary)-s.salary as saldiff from emp9 e,salary s where e.eno=s.eno 
group by e.jobtitle,e.ename,s.salary


49.display ename,jobtitle of emp who have commission percentage and belongs to dep30?
select e.ename,e.jobtitle,s.commpercen from emp9 e,salary s where e.eno=s.eno and commpercen is not null and e.dno=43


50.display details of jobs that were done by any emp who is currently more than 8000 of salary?
select e.ename,e.jobtitle,s.salary from emp9 e,salary s where e.eno=s.eno and s.salary>8000
commit
select * from emp9  desc manager
alter table manager add managersalary number
update manager set managersalary=12700 where mno=132


51)display depname,managername,salary of the manager whose exp morethan 5 years?
select d.dname,m.managername,m.managersalary,((sysdate-m.doj)/365) exp from dep2 d,manager m,emp9 e where e.mno=m.mno 
and e.dno=d.dno and ((sysdate-m.doj)/365)>10 group by d.dname,m.managername,m.managersalary,m.doj


52.display emp name if the emp joined before manager?
select e.ename,m.managername,j.doj,m.doj from emp9 e,manager m,joindate j where e.mno=m.mno and e.eno=j.eno and j.doj
select * from emphistory              
update emphistory set startdate='02-01-14' where eno=108


53.display employeename,job title for the jobs employee did in the past where the job were done less than 6 months?
select e.eno,e.ename,h.jobtitle,h.enddate-h.startdate exp from emp9 e,emphistory h where e.eno=h.eno 
and h.startdate-h.enddate<=32(this answer is not coming)


54.display empname and country in which he is working?
select * from emp9
select * from dep2
select e.ename,d.country from emp9 e,dep2 d where e.dno=d.dno


55.display depname,avg salary,no.of emp's with commission with in dep?
select d.dname,avg(s.salary),count(*) from emp9 e,dep2 d,salary s where e.dno=d.dno and e.eno=s.eno and s.commpercen is not null  group by d.dname


56.display the month in which more than 5 emp's joined in any dep located insydney?


57.display details of dep in which maximum salary is more than 10000?
select d.dname,d.dno,max(s.salary) from emp9 e,dep2 d,salary s where e.dno=d.dno and e.eno=s.eno group by d.dname,d.dno having max(s.salary)>8000


58.display details of dep managed by smith?
select * from dep2
select m.managername,e.ename,d.dname,d.dno,d.location,d.country from emp9 e,manager m,dep2 d where e.dno=d.dno and e.mno=m.mno and m.managername='suresh'


59.display jobs into which emp's joined in current year?
select e.jobtitle,e.ename,to_char(j.doj,'yyyy') from emp9 e,joindate j where e.eno=j.eno and to_char(j.doj,'yyyy')=2017
select e.jobtitle,e.ename,j.doj from emp9 e,joindate j where e.eno=j.eno and j.doj>='1-1-2017' and j.doj<='31-12-2017'


62.display country name,city and no. of dep where dep has more than 5 emp's?
select d.country,d.location,count(*) from emp9 e,dep2 d where e.dno=d.dno group by d.country,d.location having count(*)>2


63.display details of manager who manages more than 5 emp's?
select m.mno,m.managername,count(*) from emp9 e,manager m where e.mno=m.mno group by m.mno,m.managername having count(*)>5


64.display empname,jobtitle,startdate,enddate of past jobs of all amp's with comm percen is null?  
select * from emphistory
select h.eno,h.jobtitle,h.startdate,h.enddate,h.previouscompany from emp9 e,emphistory h,salary s where e.eno=h.eno 
and e.eno=s.eno and commpercen is null
select * from salary

65.display dep's into which no emp joined in last two years?
select * from dep2 where dno not in(select e.dno,j.doj from emp9 e,joindate j where e.eno=j.eno 
and floor((sysdate-j.doj)/365)<2)(this one is wrong)


66.display details of dep in which max salary is greater than 10000 for emp's who did a job in the past?
select d.dno,s.salary from dep2 d,salary s where d.dno=s.dno and 
d.dno in(select dno from emp9 where eno in(select eno from emphistory ) group by dno having max(salary)>8000)


67.display details of current job for emp's who worked as it programmer in the past?
select * from emp9 where eno in(select eno from emp9 where eno in(select eno from emphistory where jobtitle='clerk'))


68.display details of emp's drawing the highest salary?
select d.dname,e.ename,max(s.salary) from emp9 e,dep2 d,salary s where e.dno=d.dno  and e.eno=s.eno group by d.dname,e.ename


69.display the city of emp whose empid is 105?
select d.location,e.ename from emp9 e,dep2 d where e.dno=d.dno and e.eno=108
commit



